# PA 3-3 Kth 解题报告

## 1.数据结构 ##

- 二叉堆

## 2.算法原理 ##

- 以compare()函数作为比较器，分别以x, y, z为参数对[1, n]进行排序得到array1[], array2[], array3[]，从而得到a[], b[], c[]数组各下标对应值之间的大小顺序
- 排序后array1[0], array2[0], array3[0] (记为(0, 0, 0)，以此类推) 对应的a[], b[], c[]中值为最小，将其进入小顶堆
- 设堆顶为当前最小三元组(x, y, z)，其出堆后比其略大(但顺序未知)的(x + 1, y, z), (x, y + 1, z), (x, y, z + 1)入堆，通过上滤获得新的最小堆顶；如此循环k次，最后出堆的即为第k小元组
- 但如此操作会导致节点重复入堆。实际上，节点(x, y, z)只需在(x - 1, y, z), (x, y - 1, z), (x, y, z - 1)均已出堆时进行即可，因为此前(x, y, z)不可能是最小堆顶；由此，可人为规定节点入堆顺序，避免(x - 1, y, z), (x, y - 1, z), (x, y, z - 1)出堆时重复使(x, y, z)入堆。

## 3.实现要点 ##

1. 理清array1[], array2[], array3[]值、下标，a[], b[], c[]值、下标关系
2. 正确实现小顶堆插入、删除
3. 合理安排入堆顺序，避免重复。具体而言，当(x, y, z)出堆时，仅在y == 0 && z == 0时使(x + 1, y, z)入堆以引入下一个x值，仅在z == 0时使(x, y + 1, z)入堆以引入下一个y值，其余情况仅使z值递增。
4. 考虑边界情况(节点下标到达n)，避免插入错误

## 4.复杂度分析 ##

(1)时间复杂度

- 共3次排序，使用`qsort()`函数，用时`O(nlogn)`
- 共出堆k次，每次对应不超过3次入堆，因此堆规模不超过2k；故出入堆总计用时`O(klogk)`
- 时间复杂度为`O(nlogn + klogk)`

(2)空间复杂度

排序用数组有3个，规模总计`O(n)`，堆规模`O(k)`，因此空间复杂度为`O(n+k)`.

## 5.参考资料

参考讲义中二叉堆插入、删除的实现
