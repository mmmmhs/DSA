# PA 2-5 Temprature 解题报告

## 1.数据结构 ##

* kd树
* 采用完全二叉树紧凑表示

## 2.算法原理 ##

使用kd树，节点内存储子树内最高、最低温度，查询时若对应区间值不如已有结果则可剪枝舍去，不再递归；建树时不断重复按x、y坐标排序并以中点划分，先后竖切、横切生成子节点，直至切分至只有一个站点成为叶子；分别查询最大值、最小值，不断依子节点结果更新已有答案。

## 3.实现要点 ##

1. 处理输入，不断排序、划分，递归初始化子节点以建树
2. 查询：若为叶子则根据查询范围与节点范围关系确定返回值，在查询范围内返回节点值，否则无结果返回-1；若不是叶子，两子节点均无结果返回-1；若子节点在查询范围内根据大小关系更新结果；否则若子节点与查询范围相交且子树最值优于目前结果方递归进入，以此实现剪枝。

## 4.解题过程中的问题与技巧

1. 最初未标记叶子节点导致递归错误
2. 最初未正确剪枝导致时间复杂度过高

## 5.复杂度分析 ##

(1)时间复杂度

1. 建树 递归方程满足 $$T(n) = 2T(n/2)+O(nlog(n)) $$ (O(nlog(n))为快速排序复杂度），由主定理可知 $$T(n) = O(n\log^2(n))$$ .
2. 查询 单次$$O(\sqrt n)$$, 共计$$O(m\sqrt n)$$

因此时间复杂度为$$O(n\log^2n + m\sqrt n)$$.在m,n较大时，时间复杂度主要由后一项贡献。

(2)空间复杂度

存储输入使用数组，kd树使用完全二叉树紧凑表示以数组存储，共计O(n)。
