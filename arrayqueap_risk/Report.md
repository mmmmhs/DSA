# PA 1-4 Risk 解题报告

## 1.数据结构 ##

基于数组的队堆(`Queap`)，通过整数head与rear指示数组中代表`queap`开始与结束位置的下标。数组元素为自定义结构Record，分别以两个整数存储值与出现次数。(采用这一结构的原因见**4.**)

## 2.算法原理 ##

因为追溯开始时间单调非减，故可以使用`queap`维护追溯开始到结束期间的病例数，每一位存储自身及后继中的最大值，而只需队尾入列、队首出列。为此，需要在入队时将前面较小的数据以新值覆盖，此时队列起始位置值即为队列中最大值(追溯范围内最大值)。在获得每天追溯范围的最大值后，以数组存储并进行排序。每次输入分类标准，对其进行二分查找获得小于它的最大值个数便可得到答案。

## 3.实现要点 ##

(1)`queap`入队、出队操作
(2)排序、二分查找实现

## 4.解题过程中的问题与技巧

(1)为使操作简便通过数组实现`queap`，通过改变head和rear的值模拟入队、出队。在`queap`入队时需要修改前面所有较小的值，此时最坏情况可能出现`O(n)`的时间复杂度。参考习题解析10-20进行优化，使用Record存储最大值数值与重复次数，在入队时rear加一，将前面值较小的元素次数合并入新元素并删除，此时操作次数较少且实现均摊复杂度为`O(1)`。出队时将起始元素次数减一，若减为0则通过head增加方式出队。

(2)为优化程序用时采用`scanf()`替代`cin`输入。

## 5.复杂度分析 ##

(1)时间复杂度

在用`queap`求最大值的过程中，入队分摊复杂度为`O(1)`,而出队相当于遍历病例数数组，因此合计复杂度为`O(n)`。采用归并排序，复杂度为`O(nlogn)`。t次二分查找，每次复杂度为`O(logn)`，因此总复杂度为`O((n+t)logn)`。

(2)空间复杂度

造成空间复杂度的原因是存储病例数、追溯时间、最大值的数组与基于数组的`queap`，因此空间复杂度为`O(n)`。
